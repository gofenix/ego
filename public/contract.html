<html>
    <head>
        <title> 
            contract
        </title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/styles/default.min.css"
    />
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/highlight.min.js"></script>

    <script>
      hljs.highlightAll();
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      .markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    </style>
    </head>

    <body>
        <div>
            <article class="markdown-body"> 
                <hr class="thin" />
<p>
date: “2018-08-03 14:32:03”
title: contract</p>
<hr class="thin" />
<h2>
类型</h2>
<p>
Solidity是静态类型的语言。</p>
<h3>
值类型</h3>
<ul>
  <li>
bool  </li>
  <li>
int/uint  </li>
  <li>
fixed/unfixed  </li>
  <li>
address    <ul>
      <li>
balance和transfer      </li>
      <li>
send      </li>
      <li>
call, callcode和delegatecall      </li>
    </ul>
  </li>
  <li>
byte  </li>
  <li>
bytes 和 string  </li>
  <li>
十六进制hex”0012”  </li>
  <li>
enum  </li>
  <li>
function  </li>
</ul>
<h3>
引用类型</h3>
<ul>
  <li>
    <p>
数组    </p>
    <p>
uint[]     </p>
  </li>
  <li>
    <p>
结构体    </p>
    <p>
struct    </p>
  </li>
  <li>
    <p>
映射    </p>
    <p>
mapping(key =&gt; value)    </p>
  </li>
</ul>
<h2>
单元和全局变量</h2>
<ul>
  <li>
    <p>
以太币的单位    </p>
    <p>
在数字后面加上 <code class="inline">wei</code>、 <code class="inline">finney</code>、 <code class="inline">szabo</code> 或 <code class="inline">ether</code>。默认是wei    </p>
  </li>
  <li>
    <p>
时间单位    </p>
    <p>
数字后面带有 <code class="inline">seconds</code>、 <code class="inline">minutes</code>、 <code class="inline">hours</code>、 <code class="inline">days</code>、 <code class="inline">weeks</code> 和 <code class="inline">years</code>。默认是秒。    </p>
  </li>
  <li>
    <p>
区块和交易    </p>
    <ul>
      <li>
<code class="inline">block.blockhash(uint blockNumber) returns (bytes32)</code>：指定区块的区块哈希。      </li>
      <li>
<code class="inline">block.coinbase</code> (<code class="inline">address</code>): 挖出当前区块的矿工地址      </li>
      <li>
<code class="inline">block.difficulty</code> (<code class="inline">uint</code>): 当前区块难度      </li>
      <li>
<code class="inline">block.gaslimit</code> (<code class="inline">uint</code>): 当前区块 gas 限额      </li>
      <li>
<code class="inline">block.number</code> (<code class="inline">uint</code>): 当前区块号      </li>
      <li>
<code class="inline">block.timestamp</code> (<code class="inline">uint</code>): 自 unix epoch 起始当前区块以秒计的时间戳      </li>
      <li>
<code class="inline">gasleft() returns (uint256)</code>：剩余的 gas      </li>
      <li>
<code class="inline">msg.data</code> (<code class="inline">bytes</code>): 完整的 calldata      </li>
      <li>
<code class="inline">msg.gas</code> (<code class="inline">uint</code>): 剩余 gas - 自 0.4.21 版本开始已经不推荐使用，由 <code class="inline">gesleft()</code> 代替      </li>
      <li>
<code class="inline">msg.sender</code> (<code class="inline">address</code>): 消息发送者（当前调用）      </li>
      <li>
<code class="inline">msg.sig</code> (<code class="inline">bytes4</code>): calldata 的前 4 字节（也就是函数标识符）      </li>
      <li>
<code class="inline">msg.value</code> (<code class="inline">uint</code>): 随消息发送的 wei 的数量      </li>
      <li>
<code class="inline">now</code> (<code class="inline">uint</code>): 目前区块时间戳（<code class="inline">block.timestamp</code>）      </li>
      <li>
<code class="inline">tx.gasprice</code> (<code class="inline">uint</code>): 交易的 gas 价格      </li>
      <li>
<code class="inline">tx.origin</code> (<code class="inline">address</code>): 交易发起者（完全的调用链）      </li>
    </ul>
  </li>
  <li>
    <p>
地址相关    </p>
    <ul>
      <li>
<code class="inline">&lt;address&gt;.balance</code> (<code class="inline">uint256</code>):
以 Wei 为单位的 <a href="http://solidity-cn.readthedocs.io/zh/develop/types.html#address">地址类型</a> 的余额。      </li>
      <li>
<code class="inline">&lt;address&gt;.transfer(uint256 amount)</code>:
向 <a href="http://solidity-cn.readthedocs.io/zh/develop/types.html#address">地址类型</a> 发送数量为 amount 的 Wei，失败时抛出异常，发送 2300 gas 的矿工费，不可调节。      </li>
      <li>
<code class="inline">&lt;address&gt;.send(uint256 amount) returns (bool)</code>:
向 <a href="http://solidity-cn.readthedocs.io/zh/develop/types.html#address">地址类型</a> 发送数量为 amount 的 Wei，失败时返回 <code class="inline">false</code>，发送 2300 gas 的矿工费用，不可调节。      </li>
      <li>
<code class="inline">&lt;address&gt;.call(...) returns (bool)</code>:
发出低级函数 <code class="inline">CALL</code>，失败时返回 <code class="inline">false</code>，发送所有可用 gas，可调节。      </li>
      <li>
<code class="inline">&lt;address&gt;.callcode(...) returns (bool)</code>：
发出低级函数 <code class="inline">CALLCODE</code>，失败时返回 <code class="inline">false</code>，发送所有可用 gas，可调节。      </li>
      <li>
<code class="inline">&lt;address&gt;.delegatecall(...) returns (bool)</code>:
发出低级函数 <code class="inline">DELEGATECALL</code>，失败时返回 <code class="inline">false</code>，发送所有可用 gas，可调节。      </li>
    </ul>
  </li>
  <li>
    <p>
合约相关    </p>
    <p>
<code class="inline">this</code> (current contract’s type):
当前合约，可以明确转换为 <a href="http://solidity-cn.readthedocs.io/zh/develop/types.html#address">地址类型</a>。
<code class="inline">selfdestruct(address recipient)</code>:
销毁合约，并把余额发送到指定 <a href="http://solidity-cn.readthedocs.io/zh/develop/types.html#address">地址类型</a>。
<code class="inline">suicide(address recipient)</code>:
与 selfdestruct 等价，但已不推荐使用。    </p>
  </li>
</ul>
<h2>
控制结构</h2>
<p>
输入参数和我们常见的函数的参数相同</p>
<p>
输出参数必须要在returns后面，和go的类似</p>
<pre><code>function arithmetics(uint _a, uint _b) returns (uint o_sum, uint o_product) {
        o_sum = _a + _b;
        o_product = _a * _b;
}

function arithmetics(uint _a, uint _b) returns (uint , uint ) {
        o_sum = _a + _b;
        o_product = _a * _b;
        return o_sum, o_product;
}</code></pre>
<p>
不能用switch和goto</p>
<p>
内部函数调用，就和普通的方法调用一样。</p>
<p>
从外部调用合约的函数，先创建一个合约实例（和类的对象一样），然后调用实例方法。</p>
<p>
调函数要发送wei和gas，就像下图所示：</p>
<pre><code>pragma solidity ^0.4.0;

contract InfoFeed {
    function info() public payable returns (uint ret) { return 42; }
}

contract Consumer {
    InfoFeed feed;
    function setFeed(address addr) public { feed = InfoFeed(addr); }
    function callFeed() public { feed.info.value(10).gas(800)(); }
}</code></pre>
<p>
<code class="inline">payable</code> 修饰符要用于修饰 <code class="inline">info</code>，否则，.value() 选项将不可用。</p>
<p>
 可以通过new创建一个合约，和new出一个对象一样。</p>
<h2>
合约结构</h2>
<ul>
  <li>
    <p>
状态变量    </p>
    <p>
状态变量是永久存储在合约中的值，其实可以理解为类的成员变量。    </p>
  </li>
  <li>
    <p>
函数    </p>
    <p>
函数是合约的可执行单元，可以理解为类的成员函数。    </p>
  </li>
  <li>
    <p>
函数修饰器    </p>
    <p>
以声明的形式改良函数语义。    </p>
  </li>
  <li>
    <p>
事件    </p>
    <p>
以太坊的日志工具接口。    </p>
    <pre><code>event HighestBidIncreased(address bidder, uint amount); // 事件
emit HighestBidIncreased(msg.sender, msg.value); // 触发事件</code></pre>
  </li>
  <li>
    <p>
结构体    </p>
    <p>
理解为数据类。    </p>
  </li>
  <li>
    <p>
枚举    </p>
  </li>
</ul>
<p>
合约函数可见性修饰</p>

            </article>
        </div>
    </body>
</html>

    