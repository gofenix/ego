<html>
    <head>
        <title> 
            openfaas-on-rancher
        </title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/styles/default.min.css"
    />
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/highlight.min.js"></script>

    <script>
      hljs.highlightAll();
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      .markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    </style>
    </head>

    <body>
        <div>
            <article class="markdown-body"> 
                <hr class="thin" />
<p>
date: “2018-07-26 09:50:46”
title: OpenFaaS on Rancher 2.0</p>
<hr class="thin" />
<p>
这是一篇关于如何在Rancher 2.0上创建OpenFaaS栈的文章。我假设你已经准备好了Rancher 2.0集群，如果没有请按照官方文档创建一个。</p>
<p>
下面的视频展示了如何创建OpenFaaS栈，并在实际中使用：</p>
<p>
<a href="https://www.youtube.com/watch?v=kX8mXv5d1qg">https://www.youtube.com/watch?v=kX8mXv5d1qg</a>&amp;feature=youtu.be</p>
<p>
这里是创建栈的<code class="inline">compose.yml</code>文件：</p>
<pre><code class="yaml">version: &quot;2&quot;
services:
  alertmanager:
    image: functions/alertmanager:latest
    labels:
      io.rancher.container.pull_image: always
    stop_signal: SIGTERM
    restart: always
    stdin_open: true
    tty: true
    scale: 1
  faas-rancher:
    environment:
    - CATTLE_URL=${CATTLE_URL}
    - CATTLE_ACCESS_KEY=${CATTLE_ACCESS_KEY}
    - CATTLE_SECRET_KEY=${CATTLE_SECRET_KEY}
    - FUNCTION_STACK_NAME=faas-functions
    image: kenfdev/faas-rancher:v3
    labels:
      io.rancher.container.pull_image: always
    stop_signal: SIGTERM
    restart: always
    stdin_open: true
    tty: true
    scale: 1
  gateway:
    environment:
    - functions_provider_url=http://faas-rancher:8080/
    image: functions/gateway:0.6.6-beta1
    labels:
      io.rancher.container.pull_image: always
    ports:
    - 8080:8080/tcp
    stop_signal: SIGTERM
    restart: always
    stdin_open: true
    tty: true
    scale: 1
  prometheus:
    command: [-config.file=/etc/prometheus/prometheus.yml, -storage.local.path=/prometheus,
      -storage.local.memory-chunks=10000, &#39;--alertmanager.url=http://alertmanager:9093&#39;]
    image: kenfdev/prometheus:latest-cattle
    labels:
      io.rancher.container.pull_image: always
    stop_signal: SIGTERM
    restart: always
    stdin_open: true
    tty: true
    scale: 1</code></pre>
<p>
我在Rancher 2.0中找到一个比较酷的点是<code class="inline">compose.yml</code>文件中的变量都可以在UI中进行配置，如下图所示：</p>
<p>
  <img src="https://cdn-images-1.medium.com/max/800/1*EBWsJ76oelqjtXIFozZSkQ.png" alt="" />
</p>
<p>
新的<a href="https://github.com/kenfdev/faas-rancher/tree/v3">faas-rancher</a>项目已经转换为使用Rancher的v3版本的API，而且基本上已经通过了测试。欢迎贡献和反馈。</p>

            </article>
        </div>
    </body>
</html>

    