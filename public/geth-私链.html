<html>
    <head>
        <title> 
            geth-私链
        </title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/styles/default.min.css"
    />
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.1.0/build/highlight.min.js"></script>

    <script>
      hljs.highlightAll();
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      .markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    </style>
    </head>

    <body>
        <div>
            <article class="markdown-body"> 
                <hr class="thin" />
<p>
date: “2020-11-20T15:59:22+08:00”
draft: false
title: Geth 私链</p>
<hr class="thin" />
<p>
在上一篇文章<a href="https://github.com/zhenfeng-zhu/articles/issues/1">《Geth入门》</a>中，主要讲了开发环境下以太坊geth客户端的使用。今天简单说下私链的配置。</p>
<h2>
genesis.json</h2>
<pre><code class="json">{
    &quot;config&quot;: {
          &quot;chainId&quot;: 10,
          &quot;homesteadBlock&quot;: 0,
          &quot;eip155Block&quot;: 0,
          &quot;eip158Block&quot;: 0
    },
    &quot;coinbase&quot;   : &quot;0x0000000000000000000000000000000000000000&quot;,
    &quot;difficulty&quot; : &quot;0x40000&quot;,
    &quot;extraData&quot;  : &quot;&quot;,
    &quot;gasLimit&quot;   : &quot;0xffffffff&quot;,
    &quot;nonce&quot;      : &quot;0x0000000000000042&quot;,
    &quot;mixhash&quot;    : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,
    &quot;parentHash&quot; : &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,
    &quot;timestamp&quot;  : &quot;0x00&quot;,
    &quot;alloc&quot;: { }
}</code></pre>
<table>
  <thead>
    <tr>
      <th style="text-align: left;">
参数      </th>
      <th style="text-align: left;">
描述      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left;">
nonce      </td>
      <td style="text-align: left;">
nonce就是一个64位随机数，用于挖矿      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
mixhash      </td>
      <td style="text-align: left;">
与nonce配合用于挖矿，由上一个区块的一部分生成的hash      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
difficulty      </td>
      <td style="text-align: left;">
设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
alloc      </td>
      <td style="text-align: left;">
用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
coinbase      </td>
      <td style="text-align: left;">
矿工的账号，随便填      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
timestamp      </td>
      <td style="text-align: left;">
设置创世块的时间戳      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
parentHash      </td>
      <td style="text-align: left;">
上一个区块的hash值，因为是创世块，所以这个值是0      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
extraData      </td>
      <td style="text-align: left;">
附加信息，随便填，可以填你的个性信息      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
gasLimit      </td>
      <td style="text-align: left;">
该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。      </td>
    </tr>
    <tr>
      <td style="text-align: left;">
config      </td>
      <td style="text-align: left;">
Fatal: failed to write genesis block: genesis has no chain configuration ：这个错误信息，就是说，你的json文件中，缺少config部分。看到这个信息，我们不需要把geth退回到v1.5版本，而是需要加上config部分。      </td>
    </tr>
  </tbody>
</table>
<h2>
创建创世区块</h2>
<p>
打开终端，输入以下命令，在当前目录下创建创世区块。</p>
<pre><code>geth --datadir &quot;./&quot; init genesis.json</code></pre>
<p>
可以发现在当前目录新增了两个文件夹：</p>
<ul>
  <li>
geth中保存的是区块链的相关数据  </li>
  <li>
keystore中保存的是该链条中的用户信息  </li>
</ul>
<h2>
启动私链</h2>
<pre><code>geth --datadir &quot;./&quot; --nodiscover console 2&gt;&gt;geth.log</code></pre>
<ul>
  <li>
<code class="inline">--datadir</code>：代表以太坊私链的创世区块的地址  </li>
  <li>
<code class="inline">--nodiscover</code>：私链不要让公链上的节点发现  </li>
</ul>
<p>
也可将此命令写入一个shell文件中，每次启动的时候执行脚本就可以了。</p>
<p>
输入此命令后，就可以进入到geth的控制台中了，在这里可以进行挖矿，智能合约的编写。</p>

            </article>
        </div>
    </body>
</html>

    